namespace = tr_select_deity

tr_select_deity.01 = {

    type = character_event
    title = {
        first_valid = {
            triggered_desc = {
                trigger = {
                    faith = faith:satanism
                }
                desc = satanism_select_demon_decision
            }
            triggered_desc = {
                trigger = {
                    faith = faith:ds1_faith
                }
                desc = ds1_select_covenant_decision
            }
            triggered_desc = {
                trigger = {
                    OR = {
                        has_trait = possessed_1
                        has_trait = lunatic_1
                    }
                }
                desc = insanity_select_deity_decision
            }
            triggered_desc = {
                trigger = {
                    faith = faith:dwemer_religion
                }
                desc = dwemer_select_study_decision
            }
        }
    }
    desc = {
        first_valid = {
            triggered_desc = {
                trigger = {
                    faith = faith:satanism
                }
                desc = satanism_select_demon_decision_desc
            }
            triggered_desc = {
                trigger = {
                    faith = faith:ds1_faith
                }
                desc = ds1_select_covenant_decision_desc
            }
            triggered_desc = {
                trigger = {
                    OR = {
                        has_trait = possessed_1
                        has_trait = lunatic_1
                    }
                }
                desc = insanity_select_deity_decision_desc
            }
            triggered_desc = {
                trigger = {
                    faith = faith:dwemer_religion
                }
                desc = dwemer_select_study_decision_desc
            }
        }
    }

    window = visit_settlement_window
    theme = faith

    left_portrait = {
        character = root
        animation = personality_rational
    }

    ######DARK SOULS

    option = {
        name = ds1_select_covenant_aldrich
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_aldrich
                }
            }
        }
        add_trait = ds_covenant_aldrich
    }
    option = {
        name = ds1_select_covenant_blue
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_blue
                }
            }
        }
        add_trait = ds_covenant_blue
    }
    option = {
        name = ds1_select_covenant_darkmoon
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_darkmoon
                }
            }
        }
        add_trait = ds_covenant_darkmoon
    }
    option = {
        name = ds1_select_covenant_farron
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_farron
                }
            }
        }
        add_trait = ds_covenant_farron
    }
    option = {
        name = ds1_select_covenant_moundmakers
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_moundmakers
                }
            }
        }
        add_trait = ds_covenant_moundmakers
    }
    option = {
        name = ds1_select_covenant_rosaria
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_rosaria
                }
            }
        }
        add_trait = ds_covenant_rosaria
    }
    option = {
        name = ds1_select_covenant_sentinels
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_sentinels
                }
            }
        }
        add_trait = ds_covenant_sentinels
    }
    option = {
        name = ds1_select_covenant_sunlight
        trigger = {
            AND = {
                faith = faith:ds1_faith
                NOT = {
                    has_trait = ds_covenant_sunlight
                }
            }
        }
        add_trait = ds_covenant_sunlight
    }

    #####DWEMER

    option = {
        name = dwemer_choose_study_learning
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_learning
                }
            }
        }
        add_character_modifier = follow_learning
    }

    option = {
        name = dwemer_choose_study_martial
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_martial
                }
            }
        }
        add_character_modifier = follow_martial
    }

    option = {
        name = dwemer_choose_study_steward
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_steward
                }
            }
        }
        add_character_modifier = follow_steward
    }

    option = {
        name = dwemer_choose_study_health
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_health
                }
            }
        }
        add_character_modifier = follow_health
    }

    option = {
        name = dwemer_choose_study_darkness
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_darkness
                }
            }
        }
        add_character_modifier = follow_darkness
    }

    option = {
        name = dwemer_choose_study_diplomacy
        trigger = {
            AND = {
                faith = faith:dwemer_religion
                NOT = {
                    has_character_modifier = follow_diplomacy
                }
            }
        }
        add_character_modifier = follow_diplomacy
    }

    ##### LUNACY

    option = {
        name = insanity_choose_deity_cthulhu
        trigger = {
            AND = {
                NOT = {
                    has_trait = follow_cthulhu
                }
                OR = {
                    has_trait = possessed_1
                    has_trait = lunatic_1
                }
            }
        }
        add_trait = follow_cthulhu
    }
    option = {
        name = insanity_choose_deity_hastur
        trigger = {
            AND = {
                NOT = {
                    has_trait = follow_hastur
                }
                OR = {
                    has_trait = possessed_1
                    has_trait = lunatic_1
                }
            }
        }
        add_trait = follow_hastur
    }

    ##### PAGAN

    option = {
        name = pagan_choose_deity_jesus
        trigger = {
            religion = {
                family = rf_pagan
            }
        }
        add_trait = follow_jesus
    }

    ####Opt-Out

    option = {
        name = tr_select_deity_cancel
        custom_tooltip = tr_select_deity_cancel_tip
    }

}